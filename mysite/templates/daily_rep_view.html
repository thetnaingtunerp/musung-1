{% extends 'base.html' %}

{% block content %}

<div class="m-3 pl-2">
  <!-- <form action="{% url 'myapp:duedatefilter' %}" method="post">
  {% csrf_token %}
  <div class="row">
  <input type="date" name="duedate" class="form-control col-md-2">
  <input type="submit" class="btn btn-sm btn-info">
  <button type="button" class="btn btn-sm btn-primary ml-5" id="SaveData"><i class="fa-solid fa-cloud-arrow-up"></i> SaveData</button>
  </div>
  
</form> -->
<!-- <a href="#" class="h3">{{ls}}</a> -->
<!-- <form action="{% url 'myapp:backdate_dataentry' %}" method="post">
  {% csrf_token %}
  <div class="row">
  <input type="date" name="duedate" class="form-control col-md-2">
  <input type="number" name="linename" value="{{ls.id}}" hidden>
  <input type="submit" class="btn btn-sm btn-info">
  
  </div>
  
  
</form> -->



</div>

<div class="text-center row m-3">
 
  <!-- <a href="#" class="h3">{{ls}}</a> -->
  <!-- <button type="button" class="btn btn-secondary">{{ls}}</button> -->

<div class="col-md-3">  
<form action="{% url 'myapp:daily_rep_search' %}" method="get">
  <input type="number" name="lid" value="{{ls.id}}" hidden>
  <input type="text" name="emp" class="form-control" placeholder="Enter Employee Name">
  <input type="submit" value="" hidden>
</form>
</div>

<div class="col-md-5">
  <a href="#" class="h3">{{ls}}</a>
</div>

<div class="col-md-4">
  <form action="{% url 'myapp:backdate_dataentry' %}" method="post">
    {% csrf_token %}
    <div class="row">
    <input type="date" name="duedate" class="form-control col-md-6">
    <input type="number" name="linename" value="{{ls.id}}" hidden>
    <input type="submit" class="btn btn-sm btn-info">
    
    </div>
    
    
  </form>
</div>

</div>




<div class="card border-info mb-3">
  <div class="card-body">



<table class="table table-striped" id="drvtbl">
  <thead>
    <tr>
      
      <th scope="col">#</th>
      <th scope="col">Name</th>

      
      
      <th scope="col">8:30 AM</th>
      <th scope="col">9:30 AM</th>
      <th scope="col">10:30 AM</th>
      
      
      <th scope="col">11:30 AM</th>
      
     
      {% if dh >= 5 %}
      <th scope="col">1:00 PM</th>
      {% else %}
      <th></th>
      {% endif %}
      

      {% if dh >= 6 %}
      <th scope="col">2:00 PM</th>
      {% else %}
      <th></th>
      {% endif %}
     
      
      {% if dh >= 7 %}
      <th scope="col">3:00 PM</th>
      {% else %}
      <th></th>
      {% endif %}
      
     
      {% if dh >= 8 %}
      <th scope="col">4:00 PM</th>
      {% else %}
      <th></th>
      {% endif %}
     
      
      {% if dh >= 9 %}
      <th scope="col">5:00 PM</th>
      {% else %}
      <th></th>
      {% endif %}
      

      {% if dh >= 10 %}
      <th scope="col">6:00 PM</th>
      {% else %}
      <th></th>
      {% endif %}
     

      {% if dh >= 11 %}
      <th scope="col">7:00 PM</th>
      {% else %}
      <th></th>
      {% endif %}
      
      

      <th scope="col">Target</th>
      <th scope="col">Total</th>
      <th scope="col">%</th>
      <th scope="col">Remark</th>
      
      


      
    </tr>
  </thead>
  <tbody>
  	{% for i in op %}
    <tr class="drvtbltr">
      
      
      <!-- <td><a href="{% url 'myapp:dailyrep_delete' i.id %}">{{forloop.counter}}</a></td> -->
      <td><a href="#">{{i.srno}}</a></td>
      <td style="min-width: 200px;">
        {% if i.absant %}
        <a href="{% url 'myapp:update_combine' i.id %}" class="text-danger h6">{{i.operator_name}}</a>
        {% else %}
        <a href="{% url 'myapp:update_combine' i.id %}" class="text-dark">{{i.operator_name}}</a>
        {% endif %}
        
      </td>

      {% if i.workinghr > 1 %}
      <td>
        <input type="number" class="dvrtblid" value="{{i.id}}" hidden>
        
        {% if i.h1 == 0 %}
        <input type="text" name="" value="" class="form-control ih1">
        {% else %}
        <input type="text" name="" value="{{i.h1}}" class="form-control ih1">
        {% endif %}
      </td>

      {% endif %}

      <td>
        
       {% if i.h2 == 0 %}
        <input type="text" name="" value="" class="form-control ih2">
        {% else %}
        <input type="text" name="" value="{{i.h2}}" class="form-control ih2">
        {% endif %}
        
      </td>
      <td>
        
       {% if i.h3 == 0 %}
        <input type="text" name="" value="" class="form-control ih3">
        {% else %}
        <input type="text" name="" value="{{i.h3}}" class="form-control ih3">
        {% endif %}
      </td>

      {% if i.workinghr >= 4 %}
      <td>
        
        {% if i.h4 == 0 %}
        <input type="text" name="" value="" class="form-control ih4">
        {% else %}
        <input type="text" name="" value="{{i.h4}}" class="form-control ih4">
        {% endif %}
      </td>
      {% endif %}

      {% if i.workinghr >= 5 %}
      <td>
        
        {% if i.h5 == 0 %}
        <input type="text" name="" value="" class="form-control ih5">
        {% else %}
        <input type="text" name="" value="{{i.h5}}" class="form-control ih5">
        {% endif %}
      </td>
      {% else %}
      <td></td>
      {% endif %}

      {% if i.workinghr >= 6 %}
      <td>
        
        {% if i.h6 == 0 %}
        <input type="text" name="" value="" class="form-control ih6">
        {% else %}
        <input type="text" name="" value="{{i.h6}}" class="form-control ih6">
        {% endif %}
      </td>
      {% else %}
      <td></td>
      {% endif %}

      {% if i.workinghr >= 7 %}
      <td>
        
        {% if i.h7 == 0 %}
        <input type="text" name="" value="" class="form-control ih7">
        {% else %}
        <input type="text" name="" value="{{i.h7}}" class="form-control ih7">
        {% endif %}
      </td>
      {% else %}
      <td></td>
      {% endif %}

      {% if i.workinghr >= 8 %}
      <td>
        
        {% if i.h8 == 0 %}
        <input type="text" name="" value="" class="form-control ih8">
        {% else %}
        <input type="text" name="" value="{{i.h8}}" class="form-control ih8">
        {% endif %}
      </td>
      {% else %}
      <td></td>
      {% endif %}

      {% if i.workinghr >= 9 %}
      <td>
        
        {% if i.h9 == 0 %}
        <input type="text" name="" value="" class="form-control ih9">
        {% else %}
        <input type="text" name="" value="{{i.h9}}" class="form-control ih9">
        {% endif %}
      </td>
      {% else %}
      <td></td>
      {% endif %}

      {% if i.workinghr >= 10 %}
      <td>
        
        {% if i.h10 == 0 %}
        <input type="text" name="" value="" class="form-control ih10">
        {% else %}
        <input type="text" name="" value="{{i.h10}}" class="form-control ih10">
        {% endif %}
      </td>
      {% else %}
      <td></td>
      {% endif %}

      {% if i.workinghr >= 11 %}
      <td>
        
        {% if i.h11 == 0 %}
        <input type="text" name="" value="" class="form-control ih11">
        {% else %}
        <input type="text" name="" value="{{i.h11}}" class="form-control ih11">
        {% endif %}
      </td>
      {% else %}
      <td></td>
      {% endif %}


      <td>
        <strong style="font-size:18px;">{{i.target}}</strong>
      </td>
      
      <td><strong style="font-size:18px;">{{i.target_qty}}</strong></td>

      <td id="cc-{{i.id}}">      

        <!-- {{i.target_per}} -->
       

<!-- get color hourly -->
<script type="text/javascript">
var foo ={{i.hourcount}};
var rd = {{i.redcolor}};
var su = {{i.successcolor}};
switch (foo) {
  case 1:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var data = (s2/t2)*100
  
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 2: // Value of foo matches this criteria; execution starts from here
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 3: // no break statement in 'case 0:' so this case will run as well
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 4:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 5:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 6:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2 + t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 7:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2 + t2 + t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 8:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2 + t2 + t2 + t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 9:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2 + t2 + t2 + t2 + t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 10:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = t2 + t2 + t2 + t2 + t2 + t2 + t2 + t2 + t2 + t2
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  case 11:
  var s2 = {{i.target_qty}}
  var t2 = {{i.target}}/{{i.workinghr}}
  var t3 = {{i.target}}
  var data = s2/t3*100
  if (data < rd) {
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      } else if (data >= su){
        document.getElementById("cc-{{i.id}}").style.backgroundColor ='#32a852';
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
        
      }else{
        document.getElementById("cc-{{i.id}}").innerHTML = parseFloat(data).toFixed(0);
      }
    break;
  default:
    console.log("default log")
  // document.getElementById("cc-{{i.id}}").style.backgroundColor ='#ed3b3b';
}
// Logs 0 and 1

</script>


      </td>



      <td style="min-width: 130px;">
        <!-- <a href="{% url 'myapp:update_combine' i.id %}" class="btn-sm btn-info"><i class="fas fa-edit"></i></a> -->
        
        
        <a class="btn-sm btn-info" data-toggle="modal" data-target="#exampleModal-{{i.id}}"><i class="fas fa-user-cog"></i></a>
        <!-- <a href="{% url 'myapp:dailyrep_delete' i.id %}" class="btn-sm btn-danger"><i class="fas fa-trash"></i></a> -->
        <a href="" class="btn-sm btn-danger" data-toggle="modal" data-target="#myModal-{{i.id}}"><i class="fas fa-trash"></i></a>
        <!-- Modal -->
<div class="modal fade" id="exampleModal-{{i.id}}" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel-{{i.id}}"><span class="text-primary">{{i.operator_name}}</span></h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <!-- <form method="POST" action="{% url 'myapp:daily_rep_update' %}"> -->
      <div class="modal-body">
        
          <!-- Security token by Django -->
          <!-- {% csrf_token %} -->
      
          <!-- form as paragraph -->

          <input type="number" value="{{i.id}}" hidden name="repid" class="iid">
          <label for="point">Point</label>
          <input type="text" name="point" class="form-control col-md-6 point" value="{{i.point}}">

          <label for="itarget">Target</label>
          <input type="number" class="form-control col-md-6 itarget"  name="itarget" value="{{i.target}}">
          <label for="whour">Work Hour</label>
          <input type="number" class="form-control col-md-6 whour"  name="whour" value="{{i.workinghr}}">
          <hr>
          <label for="ab" class="text-danger h6">Absant : </label>
  <select name="ab" class="ab">
    {% if i.absant == False %}
    
    
    <option value="False" >Attendance</option>
    <option value="True" >Absant</option>
    {% else %}
    <option value="True" >Absant</option>
    <option value="False" >Attendance</option>
    {% endif %}
    
  </select>
  <hr>
      <label for="rmk">Remark Note</label>
          <textarea name="rmk" id="" cols="30" rows="10" class="form-control rmk">{{i.remark}}</textarea>
      
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <!-- <button type="submit" class="btn btn-info">Save Change</button> -->
        <button type="button" class="btn btn-primary rpupt">Update</button>
      </div>
    <!-- </form> -->
    </div>
  </div>
</div>
        

<!-- Trigger the modal with a button -->
<!-- <button type="button" >Open Modal</button> -->

<!-- Modal -->
<div id="myModal-{{i.id}}" class="modal fade" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content deletemodal">
      <div class="modal-header bg-danger">
        <h5 class="modal-title text-white">Are You Sure to Delete ?</h5>
        <!-- <p class="did">{{i.id}}</p> -->
         <input type="number" class="did" value="{{i.id}}" hidden>
        <button type="button" class="close text-white" data-dismiss="modal">&times;</button>
        
      </div>
      <!-- <div class="modal-body">
        <p>Some text in the modal.-{{i.id}}</p>
      </div> -->
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="button" class="btn btn-danger dbtn">Delete</button>
      </div>
    </div>

  </div>
</div>
        
      </td>


      
    </tr>
    {% endfor %}

  </tbody>
</table>



  </div>
</div>




{% endblock content %}